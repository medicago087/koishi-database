"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateRenderer = exports.renderObject = void 0;
const mustache_1 = __importDefault(require("mustache"));
const utility_1 = require("./utility");
function renderObject(object, view, visited) {
    if (!view || !object) {
        return object;
    }
    visited ??= new Set();
    if (typeof object === 'string') {
        return mustache_1.default.render(object, view, undefined, { escape: (v) => v });
    }
    if (visited.has(object)) {
        return object;
    }
    if (Array.isArray(object)) {
        visited.add(object);
        return object.map((item) => renderObject(item, view, visited));
    }
    if (typeof object === 'object') {
        visited.add(object);
        return (0, utility_1.mapValues)(object, (value) => renderObject(value, view, visited));
    }
    return object;
}
exports.renderObject = renderObject;
function generateRenderer(view) {
    return (v) => renderObject(v, view);
}
exports.generateRenderer = generateRenderer;
//# sourceMappingURL=render-object.js.map