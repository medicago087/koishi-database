import type { Pool, PoolConfig } from 'mysql';
import { Dict } from 'cosmokit';
import { Database, Driver, Eval, Field, Model, Selection } from '@minatojs/core';
import { Builder } from '@minatojs/sql-utils';
declare module 'mysql' {
    interface UntypedFieldInfo {
        packet: UntypedFieldInfo;
    }
}
declare class MySQLBuilder extends Builder {
    protected escapeMap: {
        '\0': string;
        '\b': string;
        '\t': string;
        '\n': string;
        '\r': string;
        '\u001A': string;
        '\'': string;
        '\\': string;
    };
    constructor(tables: Dict<Model>);
    escape(value: any, field?: Field<any>): string;
}
declare namespace MySQLDriver {
    interface Config extends PoolConfig {
    }
}
declare class MySQLDriver extends Driver {
    pool: Pool;
    config: MySQLDriver.Config;
    sql: MySQLBuilder;
    private _queryTasks;
    constructor(database: Database, config?: MySQLDriver.Config);
    start(): Promise<void>;
    stop(): Promise<void>;
    /** synchronize table schema */
    prepare(name: string): Promise<any>;
    _joinKeys: (keys: readonly string[]) => string;
    _formatValues: (table: string, data: object, keys: readonly string[]) => string;
    query<T = any>(sql: string): Promise<T>;
    queue<T = any>(sql: string, values?: any): Promise<T>;
    private _flushTasks;
    _select<T extends {}>(table: string, fields: readonly (string & keyof T)[], conditional?: string, values?: readonly any[]): Promise<T[]>;
    drop(table?: string): Promise<any>;
    stats(): Promise<Partial<Driver.Stats>>;
    get(sel: Selection.Immutable): Promise<any>;
    eval(sel: Selection.Immutable, expr: Eval.Expr): Promise<any>;
    private toUpdateExpr;
    set(sel: Selection.Mutable, data: {}): Promise<void>;
    remove(sel: Selection.Mutable): Promise<void>;
    create(sel: Selection.Mutable, data: {}): Promise<any>;
    upsert(sel: Selection.Mutable, data: any[], keys: string[]): Promise<void>;
}
export default MySQLDriver;
