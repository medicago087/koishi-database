/// <reference types="koa__router" />
import { RegisterMeta, Registrar } from 'cordis-decorators';
import { Context, I18n, Next, Session, Component } from 'koishi';
import { CommandConfigExtended, CommandPut, CommandPutPre, CommandReturnType, CommandTransformer } from './def';
import { IncomingMessage } from 'http';
import { DefaultContext, DefaultState, ParameterizedContext, Next as KoaNext } from 'koa';
import { RouterParamContext } from '@koa/router';
import WebSocket from 'ws';
import { Selection } from './utility/select-context';
export type KoaContext = ParameterizedContext<DefaultState, DefaultContext & RouterParamContext<DefaultState, DefaultContext>, any>;
type PutMeta = RegisterMeta<CommandPut, {
    pre?: RegisterMeta<CommandPutPre>;
}>;
declare module 'cordis-decorators' {
    namespace Registrar {
        interface MetadataMap {
            KoishiCommandPutObject: PutMeta;
        }
        interface MetadataArrayMap {
            KoishiCommandTransformer: RegisterMeta<CommandTransformer>;
            KoishiCommandPut: PutMeta;
            KoishiCommandPutObjectKeys: string;
        }
    }
}
export declare class KoishiRegistrar extends Registrar<Context> {
    decorateCommandTransformer<A extends any[]>(transformer: CommandTransformer<A>): (...args: A) => ClassDecorator & MethodDecorator;
    decorateCommandPut<A extends any[]>(put: CommandPut<A>, pre?: CommandPutPre<A>): (...args: A) => ParameterDecorator & PropertyDecorator;
    methodDecorators(): {
        RouterMethod: (method: "options" | "get" | "post" | "put" | "delete" | "patch" | "head" | "all", path: string) => import("cordis-decorators").TypedMethodDecorator<(ctx: KoaContext, Next: KoaNext) => Promise<any>>;
        Ws: (path: string) => import("cordis-decorators").TypedMethodDecorator<(socket: WebSocket, request: IncomingMessage) => any>;
        UseMiddleware: (prepend?: boolean) => import("cordis-decorators").TypedMethodDecorator<(session: Session, next: Next) => CommandReturnType>;
        UseBeforeEvent: (event: "send" | "attach-channel" | "attach-user" | "attach" | "internal/service" | "internal/update" | "parse" | "command/execute" | "command/attach-channel" | "command/attach-user", append?: boolean) => import("cordis-decorators").TypedMethodDecorator<((name: string, value: any) => void) | ((fork: import("cordis").ForkScope<import("cordis").Context.Parameterized<Context, any>>, config: any) => void) | ((this: Session<never, never>, session: Session<never, never>, args_0: import("koishi").SendOptions) => boolean | void | Promise<boolean | void>) | ((session: Session<never, never>, fields: Set<keyof import("koishi").Channel>) => void) | ((session: Session<never, never>, fields: Set<keyof import("koishi").User>) => void) | ((session: Session<never, never>) => void) | ((content: string, session: Session<never, never>) => import("koishi").Argv<never, never, any[], {}>) | ((argv: import("koishi").Argv<never, never, any[], {}>) => string | void | Promise<string | void>) | ((argv: import("koishi").Argv<never, never, any[], {}>, fields: Set<keyof import("koishi").Channel>) => void) | ((argv: import("koishi").Argv<never, never, any[], {}>, fields: Set<keyof import("koishi").User>) => void)>;
        UseCommand: (...args: [string, CommandConfigExtended?] | [string, string, CommandConfigExtended?]) => import("cordis-decorators").TypedMethodDecorator<(...args: any[]) => CommandReturnType>;
        UsePreset: (name: string) => import("cordis-decorators").TypedMethodDecorator<I18n.Renderer>;
        UseInterval: (interval: number) => import("cordis-decorators").TypedMethodDecorator<(...args: any[]) => any>;
        UseComponent: (name: string, options?: Component.Options) => import("cordis-decorators").TypedMethodDecorator<Component>;
        UseEvent: (event: keyof import("koishi").Events<Context>, prepend?: boolean) => import("cordis-decorators").TypedMethodDecorator<(...args: any[]) => any>;
        UsePlugin: () => import("cordis-decorators").TypedMethodDecorator<(...args: any[]) => import("cordis-decorators").PluginRegistrar.PluginDefinition<Context, any> | Promise<import("cordis-decorators").PluginRegistrar.PluginDefinition<Context, any>>>;
        Apply: () => import("cordis-decorators").TypedMethodDecorator<(...args: any[]) => any>;
    };
    selectorDecorators(): {
        OnAnywhere: () => ClassDecorator & MethodDecorator;
        OnNowhere: () => ClassDecorator & MethodDecorator;
        OnUser: (...args: string[]) => ClassDecorator & MethodDecorator;
        OnSelf: (...args: string[]) => ClassDecorator & MethodDecorator;
        OnGuild: (...args: string[]) => ClassDecorator & MethodDecorator;
        OnChannel: (...args: string[]) => ClassDecorator & MethodDecorator;
        OnPlatform: (...args: string[]) => ClassDecorator & MethodDecorator;
        OnPrivate: (...args: string[]) => ClassDecorator & MethodDecorator;
        OnSelection: (selection: Selection) => ClassDecorator & MethodDecorator;
    };
}
export declare const koishiRegistrar: KoishiRegistrar;
export declare const StarterPlugin: <C>(config?: import("cordis-decorators").ClassType<C>) => new (ctx: Context, config: import("cordis-decorators").PartialDeep<C>) => {
    ctx: Context;
    config: C;
};
export {};
