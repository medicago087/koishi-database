"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.sessionRxToPromise = void 0;
const rxjs_1 = require("rxjs");
async function sessionRxToPromise(session, obs) {
    const obsAwaited = await obs;
    if (!(0, rxjs_1.isObservable)(obsAwaited)) {
        return obsAwaited;
    }
    return new Promise((resolve, reject) => {
        let lastValue;
        obsAwaited.subscribe({
            next: async (value) => {
                if (lastValue && session.send) {
                    await session.send(lastValue);
                }
                lastValue = value;
            },
            error: async (error) => {
                if (lastValue && session.send) {
                    await session.send(lastValue);
                }
                reject(error);
            },
            complete: () => {
                resolve(lastValue);
            },
        });
    });
}
exports.sessionRxToPromise = sessionRxToPromise;
//# sourceMappingURL=rxjs-session.js.map